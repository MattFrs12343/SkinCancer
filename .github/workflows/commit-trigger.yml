name: ðŸŽ¯ Commit Trigger Notification

# ðŸš¨ TRIGGER: Se ejecuta en CADA commit
on:
  push:
    branches: [ '**' ]  # Todas las ramas

jobs:
  commit-notification:
    name: ðŸ“¢ Commit Notification
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout cÃ³digo
      uses: actions/checkout@v4
      
    - name: ðŸŽ‰ NotificaciÃ³n de commit
      run: |
        echo "ðŸš€ Â¡Nuevo commit detectado en OncoDerma!"
        echo "=================================="
        echo "ðŸ‘¤ Autor: ${{ github.event.head_commit.author.name }}"
        echo "ðŸ“§ Email: ${{ github.event.head_commit.author.email }}"
        echo "ðŸŒ¿ Rama: ${{ github.ref_name }}"
        echo "ðŸ“ SHA: ${{ github.sha }}"
        echo "ðŸ’¬ Mensaje: ${{ github.event.head_commit.message }}"
        echo "ðŸ“… Timestamp: ${{ github.event.head_commit.timestamp }}"
        echo "ðŸ”— URL: ${{ github.event.head_commit.url }}"
        echo "=================================="
        
    - name: ðŸ“Š AnÃ¡lisis de cambios
      run: |
        echo "ðŸ“‹ Archivos modificados:"
        git diff --name-only HEAD~1 HEAD || echo "No hay commits previos"
        echo ""
        echo "ðŸ“ˆ EstadÃ­sticas del commit:"
        git diff --stat HEAD~1 HEAD || echo "No hay commits previos"
        
    - name: ðŸ·ï¸ Detectar tipo de cambio
      run: |
        COMMIT_MSG="${{ github.event.head_commit.message }}"
        echo "ðŸ” Analizando tipo de commit..."
        
        if [[ "$COMMIT_MSG" == *"feat"* ]] || [[ "$COMMIT_MSG" == *"feature"* ]]; then
          echo "âœ¨ Tipo: Nueva funcionalidad"
        elif [[ "$COMMIT_MSG" == *"fix"* ]] || [[ "$COMMIT_MSG" == *"bug"* ]]; then
          echo "ðŸ› Tipo: CorrecciÃ³n de bug"
        elif [[ "$COMMIT_MSG" == *"docs"* ]]; then
          echo "ðŸ“š Tipo: DocumentaciÃ³n"
        elif [[ "$COMMIT_MSG" == *"style"* ]]; then
          echo "ðŸ’„ Tipo: Cambios de estilo"
        elif [[ "$COMMIT_MSG" == *"refactor"* ]]; then
          echo "â™»ï¸ Tipo: RefactorizaciÃ³n"
        elif [[ "$COMMIT_MSG" == *"test"* ]]; then
          echo "ðŸ§ª Tipo: Tests"
        else
          echo "ðŸ“ Tipo: Cambio general"
        fi
        
    - name: ðŸŽ¯ Crear issue automÃ¡tico (si es bug)
      if: contains(github.event.head_commit.message, 'fix') || contains(github.event.head_commit.message, 'bug')
      run: |
        echo "ðŸ› Bug fix detectado - se podrÃ­a crear un issue automÃ¡tico"
        echo "Commit: ${{ github.event.head_commit.message }}"
        
    - name: ðŸ“‹ Summary para GitHub
      run: |
        echo "## ðŸŽ¯ Commit Trigger Activado" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ“Š InformaciÃ³n del Commit" >> $GITHUB_STEP_SUMMARY
        echo "- **ðŸ‘¤ Autor:** ${{ github.event.head_commit.author.name }}" >> $GITHUB_STEP_SUMMARY
        echo "- **ðŸŒ¿ Rama:** ${{ github.ref_name }}" >> $GITHUB_STEP_SUMMARY
        echo "- **ðŸ“ SHA:** \`${{ github.sha }}\`" >> $GITHUB_STEP_SUMMARY
        echo "- **ðŸ’¬ Mensaje:** ${{ github.event.head_commit.message }}" >> $GITHUB_STEP_SUMMARY
        echo "- **ðŸ“… Fecha:** ${{ github.event.head_commit.timestamp }}" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸŽ‰ Trigger ejecutado exitosamente!" >> $GITHUB_STEP_SUMMARY
        echo "Este workflow se ejecuta automÃ¡ticamente en cada commit para monitorear cambios en OncoDerma." >> $GITHUB_STEP_SUMMARY